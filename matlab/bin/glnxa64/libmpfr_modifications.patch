diff -uN mpfr-2.4.2/strtofr.c mw/strtofr.c
--- mpfr-2.4.2/strtofr.c   2009-11-30 03:43:08.000000000 +0100
+++ mw/strtofr.c  2022-05-13 09:43:47.409378577 +0200
@@ -464,8 +464,11 @@
       /* prec bits corresponds to ysize limbs */
       ysize_bits = ysize * BITS_PER_MP_LIMB;
       /* and to ysize_bits >= prec > MPFR_PREC (x) bits */
-      y = (mp_limb_t*) MPFR_TMP_ALLOC ((2 * ysize + 1) * sizeof (mp_limb_t));
-      y += ysize; /* y has (ysize+1) allocated limbs */
+      /* We need to allocate one more limb to work around a documentation bug
+        https://gmplib.org/list-archives/gmp-bugs/2013-December/003267.html 
+        https://gmplib.org/repo/gmp-5.1/raw-rev/d19172622a74 */
+      y = (mp_limb_t*) MPFR_TMP_ALLOC ((2 * ysize + 2) * sizeof (mp_limb_t));
+      y += ysize; /* y has (ysize+2) allocated limbs */
 
       /* pstr_size is the number of characters we read in pstr->mant
          to have at least ysize full limbs.
diff -ruN mpfr-2.4.2/configure mw/configure
--- mpfr-2.4.2/configure	2009-11-29 21:44:35.000000000 -0500
+++ mw/configure	2020-04-15 15:32:22.341958470 -0400
@@ -20477,9 +20477,9 @@
 LIBS="-lgmp $LIBS"
 else
 
-{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for __gmpz_init in -lgmp" >&5
-$as_echo_n "checking for __gmpz_init in -lgmp... " >&6; }
-if test "${ac_cv_lib_gmp___gmpz_init+set}" = set; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for __mw__gmpz_init in -lgmp" >&5
+$as_echo_n "checking for __mw__gmpz_init in -lgmp... " >&6; }
+if test "${ac_cv_lib_gmp___mw_gmpz_init+set}" = set; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
@@ -20493,27 +20493,27 @@
 #ifdef __cplusplus
 extern "C"
 #endif
-char __gmpz_init ();
+char __mw_gmpz_init ();
 int
 main ()
 {
-return __gmpz_init ();
+return __mw_gmpz_init ();
   ;
   return 0;
 }
 _ACEOF
 if ac_fn_c_try_link "$LINENO"; then :
-  ac_cv_lib_gmp___gmpz_init=yes
+  ac_cv_lib_gmp___mw_gmpz_init=yes
 else
-  ac_cv_lib_gmp___gmpz_init=no
+  ac_cv_lib_gmp___mw_gmpz_init=no
 fi
 rm -f core conftest.err conftest.$ac_objext \
     conftest$ac_exeext conftest.$ac_ext
 LIBS=$ac_check_lib_save_LIBS
 fi
-{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gmp___gmpz_init" >&5
-$as_echo "$ac_cv_lib_gmp___gmpz_init" >&6; }
-if test "x$ac_cv_lib_gmp___gmpz_init" = x""yes; then :
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_gmp___mw_gmpz_init" >&5
+$as_echo "$ac_cv_lib_gmp___mw_gmpz_init" >&6; }
+if test "x$ac_cv_lib_gmp___mw_gmpz_init" = x""yes; then :
   LIBS="-lgmp $LIBS"
 else
   as_fn_error "libgmp not found or uses a different ABI.
diff -ruN mpfr-2.4.2/configure.in mw/configure.in
--- mpfr-2.4.2/configure.in	2009-11-29 21:43:08.000000000 -0500
+++ mw/configure.in	2020-04-15 15:29:10.463596792 -0400
@@ -444,7 +444,7 @@
 else
 
 dnl Check if we can link with GMP
-AC_CHECK_LIB(gmp, __gmpz_init, [LIBS="-lgmp $LIBS"],
+AC_CHECK_LIB(gmp, __mw_gmpz_init, [LIBS="-lgmp $LIBS"],
  [AC_MSG_ERROR(libgmp not found or uses a different ABI.
 Please read the INSTALL file -- see "In case of problem".)])
 
diff -uN mpfr-2.4.2/mpfr.h mw/mpfr.h
--- mpfr-2.4.2/mpfr.h	2023-08-02 10:17:12.745959030 +0530
+++ mw/mpfr.h	2023-08-02 10:24:31.157471156 +0530
@@ -91,11 +91,15 @@
 # endif
 #endif
 
+/* TMW Change */
 #if   _MPFR_PREC_FORMAT == 1
+typedef short mpfr_exp_t;
 typedef unsigned short mpfr_prec_t;
 #elif _MPFR_PREC_FORMAT == 2
+typedef int mpfr_exp_t;
 typedef unsigned int   mpfr_prec_t;
 #elif _MPFR_PREC_FORMAT == 3
+typedef long mpfr_exp_t;
 typedef unsigned long  mpfr_prec_t;
 #else
 # error "Invalid MPFR Prec format"
